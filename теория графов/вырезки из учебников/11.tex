\subsection{Плоские графы, формула Эйлера}

Будем говорить, что граф \textit{укладывается} на поверхности $S$, если его можно так нарисовать на $S$, что никакие два его ребра не пересекаются. Как уже отмечалось в гл. 1, мы будем использовать термины «вершины» и «рёбра» для абстрактных графов и «точки» и <<линии>> --- для геометрических графов (уложенных на некоторой поверхности). Граф называется \textit{планарным}, если его можно уложить на плоскости; \textit{плоский граф} --- это граф, уже уложенный на плоскости. Например, кубический граф, показанный на рис. ниже, \textit{а}, планарный, поскольку он изоморфен плоскому графу, изображенному на рис. ниже, \textit{б}.

\begin{figure}[h]
    \centering
    \begin{tikzpicture}[scale=1.5]
        % График а
        \begin{scope}
            % Левый квадрат с диагоналями
            \node[circle, fill=black, inner sep=2pt] (a1) at (0,0) {};
            \node[circle, fill=black, inner sep=2pt] (a2) at (1,0) {};
            \node[circle, fill=black, inner sep=2pt] (a3) at (0,1) {};
            \node[circle, fill=black, inner sep=2pt] (a4) at (1,1) {};

            % Центральные точки
            \node[circle, fill=black, inner sep=2pt] (m1) at (1.5,0.5) {};
            \node[circle, fill=black, inner sep=2pt] (m2) at (2.5,0.5) {};

            % Правый квадрат с диагоналями
            \node[circle, fill=black, inner sep=2pt] (b1) at (3,0) {};
            \node[circle, fill=black, inner sep=2pt] (b2) at (4,0) {};
            \node[circle, fill=black, inner sep=2pt] (b3) at (3,1) {};
            \node[circle, fill=black, inner sep=2pt] (b4) at (4,1) {};

            % Рёбра левого квадрата
            \draw (a1) -- (a2);
            \draw (a1) -- (a3);
            \draw (a2) -- (a4);
            \draw (a3) -- (a4);
            \draw (a1) -- (a4);
            \draw (a2) -- (a3);

            % Соединительные рёбра к центральной точке
            \draw (a2) -- (m1);
            \draw (a4) -- (m1);

            % Соединительные центральных точек
            \draw (m1) -- (m2);

            % Соединительные рёбра от центральной точки
            \draw (m2) -- (b1);
            \draw (m2) -- (b3);

            % Рёбра правого квадрата
            \draw (b1) -- (b2);
            \draw (b1) -- (b3);
            \draw (b2) -- (b4);
            \draw (b3) -- (b4);
            \draw (b1) -- (b4);
            \draw (b2) -- (b3);
        \end{scope}

        % График б
        \begin{scope}[xshift=6cm]
            % Левый ромб
            \node[circle, fill=black, inner sep=2pt] (a1) at (0.8,0.5) {};
            \node[circle, fill=black, inner sep=2pt] (a2) at (-0.5,1) {};
            \node[circle, fill=black, inner sep=2pt] (a3) at (-0.5,0) {};
            \node[circle, fill=black, inner sep=2pt] (a4) at (-1,0.5) {};
            \node[circle, fill=black, inner sep=2pt] (a5) at (0.1,0.5) {};

            % Правый ромб
            \node[circle, fill=black, inner sep=2pt] (b1) at (1.2,0.5) {};
            \node[circle, fill=black, inner sep=2pt] (b2) at (2.5,1) {};
            \node[circle, fill=black, inner sep=2pt] (b3) at (2.5,0) {};
            \node[circle, fill=black, inner sep=2pt] (b4) at (3,0.5) {};
            \node[circle, fill=black, inner sep=2pt] (b5) at (1.9,0.5) {};

            % Рёбра левого ромба
            \draw (a1) -- (a2) -- (a4) -- (a3) -- (a1);

            % Рёбра правого ромба
            \draw (b1) -- (b2) -- (b4) -- (b3) -- (b1);

            % Соединительные рёбра
            \draw (a1) -- (b1);

            \draw (a2) -- (a5);
            \draw (a3) -- (a5);
            \draw (a4) -- (a5);

            \draw (b2) -- (b5);
            \draw (b3) -- (b5);
            \draw (b4) -- (b5);
        \end{scope}

        % Подписи
        \node at (2,-0.5) {a};
        \node at (8,-0.5) {б};

    \end{tikzpicture}
    \caption{Планарный граф и его укладка.}
\end{figure}

\section*{} % Section title if needed

Области, определяемые плоским графом, назовем его \textit{гранями} (или \textit{внутренними гранями}); неограниченную область будем называть \textit{внешней гранью}. Если границей грани плоского графа является простой цикл, то иногда под гранью будем понимать этот цикл. Плоский граф, представленный на рис. 11.2, имеет две внутренние грани $f_1$, $f_2$ и одну внешнюю $f_3$. Из этих граней только $f_2$ ограничена простым циклом.

Изучение планарных графов было начато Эйлером в его исследованиях полиэдров. С каждым полиэдром связан граф, состоящий из точек и линий полиэдра; этот граф называется 1-\textit{скелетом}. Например, граф $Q_3$ есть 1-скелет куба, а $K_{2,2,2}$~--- это 1-скелет октаэдра. Формула Эйлера для полиэдров~--- один из классических результатов в математике.

\begin{theorem}[Формула Эйлера для полиэдров] \label{thm:11.1}
Для любого полиэдра, расположенного на сфере и имеющего $V$ точек, $E$ линий и $F$ граней,
\begin{equation} \label{eq:11.1}
V-E+F=2.
\end{equation}
\end{theorem}

Для 3-куба имеем $V=8$, $E=12$ и $F=6$, так что равенство \eqref{eq:11.1} выполняется; для тетраэдра $V=4$, $E=6$ и $F=4$. Прежде чем доказывать равенство \eqref{eq:11.1} в общем случае, переформулируем его в теоретико-графовых терминах. \textit{Плоской картой} называется связный плоский граф вместе со всеми его гранями. Уравнение \eqref{eq:11.1} для плоской карты (с $p$ вершинами, $q$ ребрами и $r$ гранями) будет иметь вид
\begin{equation} \label{eq:11.1prime}
p-q+r=2.
\end{equation}

Легко доказать эту теорему по индукции. Однако соотношение \eqref{eq:11.1prime} было уже доказано в гл. 4, когда мы установили, что циклический ранг $m$ связного графа $G$ определяется по формуле
\[
m=q-p+1.
\]

Будем считать, что граф $\bar{G}$ двусвязен, поскольку, как легко видеть, если соотношение (11.1') выполняется отдельно для блоков графа $G$, то оно выполняется также и для графа $G$. Таким образом, каждая грань плоской укладки графа $G$ есть простой цикл.

Мы только что отметили, что для плоской карты $p=V$ и $q=E$. Осталось только связать $m$ с $F$. Покажем, что внутренние грани плоского графа $G$ образуют базис простых циклов для графа $G$; число этих циклов, следовательно, равно $m$. Любой простой цикл $Z$ графа $G$ можно рассматривать как симметрическую разность граней графа $G$, содержащихся в $Z$. Поскольку внешняя грань есть, таким образом, сумма по модулю 2 всех внутренних граней (рассматриваемых как множества ребер), ясно, что $m=F-1$. Следовательно, соотношение $m=q-p+1$ переходит в $F-1=E-V+1$.

Из формулы Эйлера вытекает много следствий.

\begin{corollary}[11.1 (а)] Если $G$ --- плоская $(p,q)$-карта, в которой каждая грань является $n$-циклом, то \begin{equation} \label{eq:11.2} q=\frac{n(p-2)}{n-2}. \end{equation} \end{corollary}

\begin{proof} Поскольку каждая грань графа $G$ есть $n$-цикл, любое ребро в $G$ принадлежит двум граням и каждая грань имеет $n$ ребер. Тогда $nr=2q$. Подставив это в (11.1'), получим искомый результат. \end{proof}

\textit{Максимальным планарным графом} называется граф, который при добавлении любого ребра перестает быть планарным. Подстановка в (11.2) $n=3$ и $n=4$ дает

\begin{corollary}[11.1 (б)] Если $G$ --- максимальный плоский $(p,q)$-граф, то каждая его грань является треугольником и $q=3p-6$. Если $G$ --- плоский граф, у которого любая грань есть 4-цикл, то $q=2p-4$. \end{corollary}

Так как наибольшим числом рёбер в плоском графе обладает граф, у которого каждая грань есть треугольник, то получаем необходимое условие планарности графа в терминах числа рёбер.

\textbf{Следствие 11.1 (в).} \textit{Если $G$ — произвольный планарный $(p, q)$-граф и $p \geq 3$, то $q \leq 3p - 6$. Если граф $G$ двусвязан и не содержит треугольников, то $q \leq 2p - 4$.}

\textbf{Следствие 11.1 (г).} \textit{Графы $K_5$ и $K_{3,3}$ не являются планарными.}

\textbf{Доказательство.} Граф $K_5$ есть $(5,10)$-граф и не может быть планарным, так как $q = 10 > 9 = 3p - 6$; для $K_{3,3}$ имеем $q = 9$ и $2q - 4 = 8$.

\textbf{Следствие 11.1 (а).} Каждый планарный граф $G \subseteq P \geq 4$ вершинами имеет по крайней мере четыре вершины со степенями, не превышающими 5.

Ясно, что граф планарный тогда и только тогда, когда каждая его компонента — планарный граф. Уитни [3] показал, что при исследовании планарности достаточно рассматривать двусвязные графы.

\textbf{Теорема 11.2.} Граф планарен тогда и только тогда, когда каждый его блок планарен.

Интуитивно очевидно, что любой планарный граф можно уложить на сфере, и обратно. Это замечание позволяет понять, что планарный граф можно уложить на плоскости многими различными способами.

\textbf{Теорема 11.3.} Для любой выделенной грани $f$ двусвязного плоского графа $G$ найдётся на плоскости изоморфный ему плоский граф, у которого грань, соответствующая грани $f$, будет внешней.

\textbf{Доказательство.} Пусть $f$ — внешняя грань плоского блока $G$. Уложим $G$ на сфере и выделим некоторую внутреннюю относительно $f$ точку (назовем её «северным полюсом»). Проведем касательную плоскость к сфере через «южный полюс» и спроецируем $G$ на плоскость из «северного полюса». В результате получим плоский граф, изоморфный графу $G$, в котором $f$ — внешняя грань.

\textbf{Следствие 11.3 (а).} Для любого выделенного ребра планарного графа найдётся такая укладка этого графа на плоскости, что выделенное ребро будет принадлежать внешней грани.

Уитни также доказал, что каждый максимальный планарный граф является блоком. Более того, справедлива

\textbf{Теорема 11.4 (Уитни).} Каждый максимальный планарный граф, имеющий $p \geq 4$ вершины, трёхсвязен.

Существует пять способов укладки трёхсвязного колеса $W_5$ на плоскости: один из них изображен на рис. 11.3, а, остальные четыре — на рис. 11.3, б. Однако на сфере граф $W_5$ можно уложить лишь единственным способом. Это относится и ко всем трёхсвязным графам (Уитни [4]).

\footnotetext[1]{Обычно результат описанного проектирования называют стереографической проекцией.}

\textbf{Теорема 11.5.} Любой трёхсвязный планарный граф единственным образом укладывается на сфере.

Для того чтобы доказать необходимость трёхсвязности, рассмотрим изоморфные двусвязные графы $G_1$ и $G_2$, представленные на рис. 11.4. Граф $G_1$ укладывается на сфере так, что ни одна из его областей не ограничена пятью рёбрами, в то время как $G_2$ имеет две области, ограниченные пятью рёбрами.

Многогранник называется \textit{выпуклым}, если отрезок прямой, соединяющий две произвольные точки многогранника, лежит целиком внутри многогранника. Следующая теорема принадлежит Штейнитцу и Радемахеру \cite{1}.

\textbf{Теорема 11.6.} Граф является 1-скелетом выпуклого трёхмерного многогранника тогда и только тогда, когда он планарен и трёхсвязен.

Одна из наиболее увлекательных областей исследований в теории планарных графов посвящена взаимосвязи между графом как комбинаторным объектом и графом как геометрической фигурой. Очень часто возникает вопрос о существовании специальной укладки графа (при тех или иных геометрических ограничениях). Например, Вагнер \cite{1}, Фари \cite{1} и Штейн \cite{1} независимо показали, что каждый планарный граф можно уложить на плоскости так, что каждое его ребро будет отрезком прямой.

\textbf{Теорема 11.7.} Любой планарный граф изоморфен плоскому графу, у которого все рёбра являются отрезками прямыми.
